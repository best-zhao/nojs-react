webpackJsonp([13],{296:function(t,e,i){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=i(5);a(document.body).append("<style>.addIndex{z-index:99999}</style>");var o=function(t,e,i){this.drag=t,this.opt=i=i||{},this.move=e||t,this.delegat=!0===i.delegat,this.setDrag=i.setDrag,this.moveing=!1,this.onDragDown=i.onDragDown,this.onDragStart=i.onDragStart,this.MoveEvent=i.MoveEvent,this.UpEvent=i.UpEvent,this.dragLastPos=[],this.dragNowPos=[],this.mouseLastPos={},this.disable=!1,this.limit=i.limit,this.wrap=i.wrap,this.overflow=i.overflow,this.A=null,this.delay=this.opt.delay||9,this.delegat;var s=this;this.move.bind("mousedown.drag",function(t){s.DragDown(t)})};o.prototype={DragDown:function(t){if(this.disable)return!1;t=t||window.event;var e,i,o,r,n,h,l,d,f=this,c=a(t.target);if(this.delegat&&(c.attr("isdrag")||c.attr("isdragmove")?this.drag=c.attr("isdragmove")?c.closest("[isdrag]"):c:this.drag=null),this.drag&&this.drag.length){if(this.onDragDown&&0==this.onDragDown.call(this,t))return!1;for(this.moveing=!0,this.dragNowPos=[],this.dragLastPos=[],this.maxSize={L:[],T:[],B:[],R:[],W:null,H:null},this.group=this.group||this.drag,this.drag.addClass("addIndex"),o=0,r=this.drag.length;o<r;o++)i=this.drag.eq(o),e="static"===i.css("position"),n=e?i.offset().left:parseInt(i.css("left"),10)||0,h=e?i.offset().top:parseInt(i.css("top"),10)||0,this.wrap&&this.wrap.length&&(n-=this.wrap.offset().left-this.wrap.scrollLeft(),h-=this.wrap.offset().top-this.wrap.scrollTop()),l=i.outerWidth(),d=i.outerHeight(),this.dragLastPos.push({x:n,y:h}),e&&i.css({position:"absolute"}),i.css({left:n,top:h}),this.group&&!i.is(this.group)||(this.maxSize.L.push(n),this.maxSize.T.push(h),this.maxSize.R.push(n+l),this.maxSize.B.push(h+d));if(t.preventDefault(),this.maxSize.L=Math.min.apply(null,this.maxSize.L),this.maxSize.T=Math.min.apply(null,this.maxSize.T),this.maxSize.W=Math.max.apply(null,this.maxSize.R)-this.maxSize.L,this.maxSize.H=Math.max.apply(null,this.maxSize.B)-this.maxSize.T,this.limit&&(this.maxSize.l=this.limit.offset().left+parseInt(this.limit.css("border-left-width")),this.maxSize.t=this.limit.offset().top+parseInt(this.limit.css("border-top-width")),"static"!==this.limit.css("position")&&this.limit.find(i).length&&(this.maxSize.l=this.maxSize.t=0),this.maxSize.w=this.limit.innerWidth()-this.maxSize.W+this.maxSize.l,this.maxSize.h=this.limit.innerHeight()-this.maxSize.H+this.maxSize.t,this.overflow)){if("object"==s(this.overflow))var u=this.overflow,n=u.x,h=u.y,p=u.width,m=u.height;else{var n,h,p,m;n=h=p=m=this.overflow}this.maxSize.l-=n,this.maxSize.t-=h,this.maxSize.w+=p,this.maxSize.h+=m}if(this.mouseLastPos={x:t.clientX,y:t.clientY},this.onDragStart&&0==this.onDragStart.call(this,t))return!1;a(document).bind("mousemove.drag",function(t){f.DragMove(t)}).bind("mouseup.drag",function(t){f.DragUp(t)})}},DragMove:function(t){if(this.moveing&&!this.disable&&this.drag){t=t||window.event,t.preventDefault();var e,i,s,a,o,r={x:t.clientX-this.mouseLastPos.x,y:t.clientY-this.mouseLastPos.y},n=r.x,h=r.y,l=this.drag.length,d=this;for(this.limit&&(a=this.maxSize.L+n,o=this.maxSize.T+h,r.x=a<this.maxSize.l?this.maxSize.l-this.maxSize.L:n,r.x=a>this.maxSize.w?this.maxSize.w-this.maxSize.L:r.x,r.y=o<this.maxSize.t?this.maxSize.t-this.maxSize.T:h,r.y=o>this.maxSize.h?this.maxSize.h-this.maxSize.T:r.y),this.setOffset&&(r=this.setOffset.call(this,r)),n=r.x,h=r.y,e=0;e<l;e++)i=this.drag.eq(e),s=this.dragLastPos[e],this.dragNowPos[e]={x:s.x+n,y:s.y+h},i.css({left:this.dragNowPos[e].x,top:this.dragNowPos[e].y});this.MoveEvent&&(clearTimeout(d.A),d.A=setTimeout(function(){d.MoveEvent.call(d,{x:n,y:h,w:d.maxSize.W,h:d.maxSize.H,left:s.x+n,top:s.y+h},t)},d.delay))}},DragUp:function(t){if(!this.disable){var e=this;this.moveing=!1,a(document).off("mousemove.drag mouseup.drag"),this.drag.removeClass("addIndex"),e.A=clearTimeout(e.A),this.UpEvent&&this.UpEvent.call(this,t),this.maxSize=this.dragLastPos=this.dragNowPos=null,t.preventDefault()}}},t.exports=o},76:function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.getContentOptions=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),h=i(5),l=s(h),d=i(17),f=i(296),c=s(f),u=function(t){function e(t){a(this,e);var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),s=i.props.layers,r=void 0===s?[]:s;return i.state={layers:r},i}return r(e,t),n(e,[{key:"push",value:function(t,e){var i=this.state.layers;e>=i.length?i.push(t):i.splice(e,0,t),t.id=i.length,this.setState({layers:i})}},{key:"render",value:function(){var t=this,e=this.state,i=e.layers;e.focus,e.editor,this.props.root;return d.React.createElement("div",null,i.map(function(e,s){return d.React.createElement(p,{key:e.id,layers:i,parent:t,index:s},d.React.createElement("div",{className:"content-item",ref:"layer-"+s},d.React.createElement("div",{className:"inner"},d.React.createElement("div",{className:"ct-head"},e.id),d.React.createElement("div",{className:"ct-body"}))))}),d.React.createElement("div",{className:"content-item d_hide drag-holder drag-newholder",ref:"holder"}))}}]),e}(d.React.Component);e.default=u;var p=function(t){function e(){return a(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,t),n(e,[{key:"componentDidMount",value:function(){var t=this,e=(0,l.default)(d.ReactDOM.findDOMNode(this)),i=this.props,s=i.onDragDown,a=(i.onDragMove,i.onDragUp),o=i.parent,r=(0,l.default)("div.canvas-content"),n=void 0;this.holder=e.clone().addClass("drag-holder"),this.drag=new c.default(e,null,{wrap:r}),this.drag.onDragDown=function(i){var a=e.offset();e.css({position:"absolute",top:a.top,left:a.left,width:e.width()}).addClass("drag-target").after(t.holder),r.addClass("drag-active"),s&&s.call(this,t.props),n=t.props.index},this.drag.MoveEvent=function(i,s){for(var a=s.clientY,r=void 0,h=void 0,d=void 0,f=t.props.layers,c=0;c<f.length+1;c++)if(r=(0,l.default)(o.refs["layer-"+c]),r.length&&(h=r.offset().top,d=r.outerHeight(!0),r[0]!==e[0]&&r[0]!==t.holder[0]&&a>h&&a<h+d)){n>c?t.holder.insertBefore(r):t.holder.insertAfter(r);var u=f[n];f.splice(n,1),f.splice(c,0,u),n=c;break}},this.drag.UpEvent=function(i){t.holder.after(e),t.holder.remove(),e.removeClass("drag-target").removeAttr("style"),r.removeClass("drag-active"),a&&a.call(this),o.forceUpdate()}}},{key:"componentWillReceiveProps",value:function(t){}},{key:"render",value:function(){return this.props.children}}]),e}(d.React.Component);e.getContentOptions=function(t){var e=void 0,i=void 0,s=void 0,a=void 0,o=t.props.root,r=o.state.data.content.layers,n=void 0;return{onDragDown:function(n){var h=o.canvas,f=h.el,c=h.areas,u=f.offset(),p=u.top,m=u.left;i=p,s=m,e=c.filter('[data-dragarea="'+n.target+'"]'),a=(0,l.default)(d.ReactDOM.findDOMNode(t)).offset().left,r=o.state.data.content.layers},onDragMove:function(t,i){var h=o.canvas,d=h.el,f=h.areas;o.canvas.target=null,f.removeClass("drag-active");var c=e.offset().top,u=e.outerHeight(),p=s,m=d.outerWidth();if(t>p&&t<p+m&&i>c&&i<c+u&&t<a){o.canvas.target=e.addClass("drag-active");for(var g=e.find("div.drag-newholder").show(),v=void 0,y=void 0,x=void 0,w=r.props.layers,S=0;S<w.length+1;S++){if(v=(0,l.default)(r.refs["layer-"+S]),y=v.offset().top,x=v.outerHeight(!0),i<y+x/2){g.insertBefore(v),n=S;break}g.insertAfter(v),n=S+1}}},onDragUp:function(t,e,a){var h=o.canvas,l=(h.el,h.target);if(h.areas.removeClass("drag-active"),l){var d=e-i,f=t-s,c=Object.assign({x:f,y:d},a.module);r.push(c,n)}l&&l.find("div.drag-newholder").hide(),o.canvas.target=null}}}}});